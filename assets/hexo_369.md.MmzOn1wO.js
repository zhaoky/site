import{_ as e,c as s,o as a,U as i}from"./chunks/framework.UMIDyG6S.js";const u=JSON.parse('{"title":"Unable to preventDefault inside passive event listener due to target being treated as passive","description":"","frontmatter":{},"headers":[],"relativePath":"hexo/369.md","filePath":"hexo/369.md"}'),t={name:"hexo/369.md"},n=i(`<h1 id="unable-to-preventdefault-inside-passive-event-listener-due-to-target-being-treated-as-passive" tabindex="-1">Unable to preventDefault inside passive event listener due to target being treated as passive <a class="header-anchor" href="#unable-to-preventdefault-inside-passive-event-listener-due-to-target-being-treated-as-passive" aria-label="Permalink to &quot;Unable to preventDefault inside passive event listener due to target being treated as passive&quot;">​</a></h1><h2 id="事件现象" tabindex="-1">事件现象 <a class="header-anchor" href="#事件现象" aria-label="Permalink to &quot;事件现象&quot;">​</a></h2><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">document.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addEventListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;touchstart&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">e</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  e.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">preventDefault</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><p><code>chrome</code> 控制台报错：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[Intervention] Unable to preventDefault inside passive event listener due to target being treated as passive. See https://www.chromestatus.com/features/5093566007214080</span></span></code></pre></div><p>在 <code>document</code> 上监听 <code>touch</code> 类事件时，如果在 <code>handler</code> 里调用了 <code>e.preventDefault()</code>，则会报错：<code>不能给passive(被动的)事件监听器 preventDefault，因为它被认为是 passive</code></p><h2 id="相关知识" tabindex="-1">相关知识 <a class="header-anchor" href="#相关知识" aria-label="Permalink to &quot;相关知识&quot;">​</a></h2><p><code>addEventListener()</code> 的第三个参数（可选）为以下二选一:</p><ul><li><code>useCapture</code> （<code>boolean</code>，默认值<code>false</code>）为 <code>true</code> 表示 <code>listener</code> 会在该类型的事件<code>捕获</code>阶段传播到该 <code>EventTarget</code> 时触发</li><li><code>options</code> （<code>object</code>） <ul><li><code>capture</code> （<code>boolean</code>，默认值 <code>false</code>,同 <code>useCapture</code>）</li><li><code>once</code> (<code>boolean</code>，默认值 <code>false</code>) 为 <code>true</code> 表示 <code>listener</code> 在添加之后最多只调用一次</li><li><code>passive</code> (<code>boolean</code>，默认值 <code>false</code> ) 为 <code>true</code> 表示 <code>listener</code> 调用 <code>preventDefault()</code> 无效并报错</li></ul></li></ul><h2 id="事件原因" tabindex="-1">事件原因 <a class="header-anchor" href="#事件原因" aria-label="Permalink to &quot;事件原因&quot;">​</a></h2><p>从 <code>Chrome 56</code> 开始，如果我们给 <code>document</code> 绑定 <code>touchmove</code> 或者 <code>touchstart</code> 事件的监听器，这个 <code>passive</code> 是会被默认设置为<code>true</code> 以提高性能<a href="https://www.chromestatus.com/feature/5093566007214080" target="_blank" rel="noreferrer">查阅</a></p><h2 id="解决方法" tabindex="-1">解决方法 <a class="header-anchor" href="#解决方法" aria-label="Permalink to &quot;解决方法&quot;">​</a></h2><ul><li>避免在 <code>handler</code> 里调用 <code>e.preventDefault()</code>,提高性能</li><li><code>addEventListener</code> 里第三个参数设置为 <code>{passive:false}</code></li></ul><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">document.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addEventListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;touchstart&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">e</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    e.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">preventDefault</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    passive: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div>`,14),l=[n];function d(o,p,h,c,r,k){return a(),s("div",null,l)}const g=e(t,[["render",d]]);export{u as __pageData,g as default};
